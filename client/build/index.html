<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Test Backend API</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    .container {
      display: flex;
      justify-content: space-between;
    }
    .ads-container, .users-container {
      width: 48%;
      padding: 10px;
      box-sizing: border-box;
    }
    .ads-container {
      border-right: 1px solid #ddd;
    }
    section {
      margin-bottom: 20px;
    }
    button, input, textarea {
      display: block;
      margin-top: 5px;
      width: 100%;
      max-width: 300px;
    }
  </style>
</head>
<body>
  <h1>Backend API Test</h1>
  <div class="container">
    <div class="ads-container">
      <section>
        <h2>Get All Ads</h2>
        <button id="getAdsBtn">Get Ads</button>
        <div id="adsContainer"></div>
      </section>
      <section>
        <h2>Create Ad</h2>
        <form id="createAdForm">
          <p>
            <label>Title:
              <input type="text" name="title" required>
            </label>
          </p>
          <p>
            <label>Description:
              <textarea name="description" required></textarea>
            </label>
          </p>
          <p>
            <label>Photo (URL):
              <input type="text" name="photo" required>
            </label>
          </p>
          <p>
            <label>Price:
              <input type="number" name="price" required>
            </label>
          </p>
          <p>
            <label>Location:
              <input type="text" name="location" required>
            </label>
          </p>
          <p>
            <label>Seller Info:
              <input type="text" name="sellerInfo" required>
            </label>
          </p>
          <button type="submit">Create Ad</button>			
        </form>
      </section>
    </div>
    <div class="users-container">
      <section>
        <h2>Register User</h2>
        <form id="registerForm">
          <label>
            Login:
            <input type="text" name="login" required>
          </label>
          <label>
            Password:
            <input type="password" name="password" required>
          </label>
          <label>
            Avatar (URL):
            <input type="text" name="avatar">
          </label>
          <label>
            Phone:
            <input type="text" name="phone">
          </label>
          <button type="submit">Register</button>
        </form>
      </section>
      <section>
        <h2>Login</h2>
        <form id="loginForm">
          <label>
            Login:
            <input type="text" name="login" required>
          </label>
          <label>
            Password:
            <input type="password" name="password" required>
          </label>
          <button type="submit">Login</button>
        </form>
      </section>
      <section>
        <h2>Get Current User Info</h2>
        <button id="getUserBtn">Get User Info</button>
        <div id="userInfo"></div>
      </section>
      <section>
        <h2>Logout</h2>
        <button id="logoutBtn">Logout</button>
      </section>
    </div>
  </div>
  <script>
    document.getElementById('getAdsBtn').addEventListener('click', function() {
      fetch('/api/ads')
        .then(response => response.json())
        .then(data => {
          document.getElementById('adsContainer').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
        })
        .catch(err => console.error('Error fetching ads:', err));
    });
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const data = {
        login: formData.get('login'),
        password: formData.get('password'),
        avatar: formData.get('avatar'),
        phone: formData.get('phone')
      };
      fetch('/auth/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(result => alert('Register: ' + JSON.stringify(result)))
      .catch(err => console.error('Error during registration:', err));
    });
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const data = {
        login: formData.get('login'),
        password: formData.get('password')
      };
      fetch('/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include',
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(result => alert('Login: ' + JSON.stringify(result)))
      .catch(err => console.error('Error during login:', err));
    });
    document.getElementById('getUserBtn').addEventListener('click', function() {
      fetch('/auth/user', {
        method: 'GET',
        credentials: 'include'
      })
      .then(response => response.json())
      .then(user => {
        document.getElementById('userInfo').innerHTML = '<pre>' + JSON.stringify(user, null, 2) + '</pre>';
      })
      .catch(err => console.error('Error fetching user info:', err));
    });
    document.getElementById('logoutBtn').addEventListener('click', function() {
      fetch('/auth/logout', {
        method: 'DELETE',
        credentials: 'include'
      })
      .then(response => response.json())
      .then(result => alert('Logout: ' + JSON.stringify(result)))
      .catch(err => console.error('Error during logout:', err));
    });
    document.getElementById('createAdForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const data = {
        title: formData.get('title'),
        description: formData.get('description'),
        photo: formData.get('photo'),
        price: formData.get('price'),
        location: formData.get('location'),
        sellerInfo: formData.get('sellerInfo')
      };
      fetch('/api/ads', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include',
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(result => alert('Create Ad: ' + JSON.stringify(result)))
      .catch(err => console.error('Error creating ad:', err));
    });
  </script>
</body>
</html>
